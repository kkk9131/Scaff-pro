# Scaff-Pro 開発進捗

このファイルはAIエージェントによる開発作業の進捗を記録します。

---

## フェーズ0: 環境構築 ✅ (2025-12-05)

### 完了項目
- [x] Next.js + TypeScript + Tailwind セットアップ完了
- [x] 必要パッケージインストール（Zustand, Konva, Three.js, react-rnd等）
- [x] ディレクトリ構造作成（features, hooks, store等）
- [x] FastAPI + Python セットアップ完了
- [x] Python仮想環境作成・パッケージインストール
- [x] scaffold_logic パッケージ作成完了（types.py, core.py）
- [x] フロントエンド・バックエンド起動確認済み

### 起動コマンド
```bash
# フロントエンド（http://localhost:3000）
cd frontend && npm run dev

# バックエンド（http://localhost:8000）
cd backend && source .venv/bin/activate && uvicorn app.main:app --reload
```

---

## フェーズ1: Screen B（キャンバス画面）UI構築 ✅ (2025-12-05)

### 完了項目
- [x] **デザインシステム構築**: ダークモード＋ネオンアクセントの「Modern Industrial」テーマ適用
- [x] **メインレイアウト**: `PlanningLayout` 実装（ヘッダー、サイドバー等）
- [x] **2D キャンバス**: `Konva` ベースの作図エリア実装（ズーム・パン対応）
- [x] **3D ビュー**: `Three.js` によるワイヤーフレーム表示実装
- [x] **ツールパレット**: フローティングツールバー実装（選択、ポリライン等）
- [x] **サイドパネル**: タブ切り替え式パネル実装（建物情報、足場条件、数量、チャット）
- [x] **参照図面ビューア**: ドラッグ可能なフローティングウィンドウ実装

---

## フェーズ2: 図面インポート・作図・3D可視化 ✅ (2025-12-05)

### 完了項目
- [x] **状態管理**: `planningStore.ts` 作成（Zustand）
- [x] **図面アップロード**: SidePanelからファイル選択 → ReferenceViewerに表示
- [x] **スケール設定**: プリセットボタン(1:50, 1:100, 1:200, 1:250) + 2点クリック
- [x] **ポリライン作図**: クリックで頂点追加、Shift+クリックで直角スナップ、ダブルクリック確定
- [x] **建物高さ設定**: 階高・階数・屋根高を入力可能に
- [x] **3D可視化**: ポリライン→3Dワイヤーフレーム建物生成
- [x] **ビューモード切替**: 2D / 3D（自由視点）/ ISO（等角投影）/ PERSP（固定パース）

---

## フェーズ3: AI図面解析・自動作図 🔜
*次のフェーズ*

### 計画内容
- [ ] **Claude Vision API統合**: 図面画像解析機能の実装
- [ ] **平面図自動解析**: 壁線・外周ポリライン・寸法情報の自動抽出
- [ ] **立面図自動解析**: 高さ情報（階高・軒高・階数）の自動抽出
- [ ] **自動作図フロー**: ワンクリックで図面→3D建物生成
- [ ] **解析結果プレビューUI**: 抽出結果の確認・微調整機能

---

## フェーズ4: 足場自動割付・計算 (計画)
*フェーズ3の後に実装*

### 計画内容
- [ ] **既存足場ロジック統合**: `scaffold_logic`をバックエンドAPIに接続
- [ ] **2D足場表示**: 支柱・スパンをキャンバスに描画
- [ ] **3D足場表示**: 支柱・布材・手すりを3Dワイヤーフレームで表示
- [ ] **数量集計**: 部材種別×規格×面別の集計・CSV/Excelエクスポート
- [ ] **条件調整・再計算**: スパン・階高ピッチ等のパラメータ調整機能

---

## 更新履歴
| 日付 | 内容 |
|------|------|
| 2025-12-05 | フェーズ4計画追加（足場自動割付・計算機能）|
| 2025-12-05 | フェーズ3計画策定（AI図面解析・Claude Vision活用）|
| 2025-12-05 | ビューモード分離（3D自由視点/ISO等角投影/PERSPパース固定）、3D影削除 |
| 2025-12-05 | 3D可視化機能追加（ポリライン→3Dワイヤーフレーム、高さ設定UI）|
| 2025-12-05 | フェーズ2完了（図面アップロード、スケール設定、ポリライン作図）|
| 2025-12-05 | フェーズ1完了（Screen B UI構築）|
| 2025-12-05 | フェーズ0完了、技術スタックをNext.jsに変更 |
